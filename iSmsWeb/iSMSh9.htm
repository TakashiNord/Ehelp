<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{mso-style-link:"Заголовок 1 Знак";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	line-height:115%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Cambria","serif";}
h2
	{mso-style-link:"Заголовок 2 Знак";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-style:italic;}
h3
	{mso-style-link:"Заголовок 3 Знак";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	line-height:115%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Cambria","serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Верхний колонтитул Знак";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Нижний колонтитул Знак";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{mso-style-link:"Без интервала Знак";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:36.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:36.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.1
	{mso-style-name:"Заголовок 1 Знак";
	mso-style-link:"Заголовок 1";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.2
	{mso-style-name:"Заголовок 2 Знак";
	mso-style-link:"Заголовок 2";
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
span.3
	{mso-style-name:"Заголовок 3 Знак";
	mso-style-link:"Заголовок 3";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.a
	{mso-style-name:"Верхний колонтитул Знак";
	mso-style-link:"Верхний колонтитул";}
span.a0
	{mso-style-name:"Нижний колонтитул Знак";
	mso-style-link:"Нижний колонтитул";}
span.a1
	{mso-style-name:"Без интервала Знак";
	mso-style-link:"Без интервала";
	font-family:"Times New Roman","serif";}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:2.0cm 42.5pt 2.0cm 3.0cm;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=RU link=blue vlink=purple>

<div class=WordSection1>

<h1>Настройка сервера точного времени <span lang=EN-US>NTP</span><span
lang=EN-US> </span>для синхросигнала по протоколу <span lang=EN-US>NMEA</span>
для ЭНКС-2 -1.1.1/2</h1>

<h2>Задача:</h2>

<p class=MsoNormal>Установить <span lang=EN-US>NTP</span><span lang=EN-US> </span>сервер,
которой синхронизируется от <span lang=EN-US>GPS</span><span lang=EN-US> </span>источника
по протоколу <span lang=EN-US>NMEA</span>. В случае отсутствия сигнала с <span
lang=EN-US>GPS</span><span lang=EN-US> </span>приемника, сервер должен
раздавать время со своих локальных часов.</p>

<p class=MsoNormal>В качестве <span lang=EN-US>GPS</span><span lang=EN-US> </span>источника
времени можно использовать любое устройство поддерживающее протокол <span
lang=EN-US>NMEA</span>. Для примера используем ЭНКС-2.</p>

<p class=MsoNormal>В качестве серверной ОС используется <span lang=EN-US>Debian</span>
7.</p>

<h2>Решение:</h2>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal>Антенна должна видеть небо, а не землю и стены соседних
     строений. Т.е. должна находиться на открытом воздухе и смотреть вверх.</li>
 <li class=MsoNormal>Изготавливаем соединительный кабель <span lang=EN-US>DB</span>-2
     (Мама) / <span lang=EN-US>RG</span>-45 (См документация на ЭНКС-2)</li>
 <li class=MsoNormal>Конфигурируем ЭНКС-2  с помощью программы <span
     lang=EN-US>SQ</span>_<span lang=EN-US>Monitor</span><span lang=EN-US> </span> с
     диска ЭНКС-2 либо с помощью TrimbleStudio_V1-01-21  устанавливая следующие
     параметры:</li>
 <ol style='margin-top:0cm' start=1 type=a>
  <li class=MsoNormal>Последовательный порт 9600, 1 стоповый, без четности.  (По
      умолчанию у ЭНКС-2 стоит четность).</li>
  <li class=MsoNormal>Выходной протокол <span lang=EN-US>NMEA</span></li>
  <li class=MsoNormal>Время в формате <span lang=EN-US>UTC</span></li>
 </ol>
 <li class=MsoNormal>Проверяем, что спутники видны, время идет правильно,
     моргают лампочки на панели ЭНКС-2</li>
 <li class=MsoNormal>Выключаем и включаем ЭНКС-2</li>
 <li class=MsoNormal>Подключаем к компьютеру (или серверу <span lang=EN-US>iSMS</span>)
     ЭНКС-2 через последовательный порт или преобразователь <span lang=EN-US>USB</span>2/<span
     lang=EN-US>COM</span>.  Подключаемся любой терминальной программой.
     Устанавливаем параметры коммуникационного порта, заданные в п.3 и должны
     наблюдать пакеты протокола <span lang=EN-US>NMEA</span> примерно
     следующего вида:</li>
</ol>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>$GPGGA,<span
style='background:lime'>065912.00</span>,5503.9363,N,08253.9330,E,1,06,2.78,00147,M,-036,M,,*4D</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>$GPVTG,000.0,T,351.1,M,000.0,N,000.0,K,A*25</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>$GPGGA,<span
style='background:lime'>065913.00</span>,5503.9365,N,08253.9327,E,1,06,2.78,00147,M,-036,M,,*4C</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>$GPVTG,000.0,T,351.1,M,000.0,N,000.0,K,A*25</span></p>

<p class=MsoNormal style='border:none;padding:0cm'>$GPGGA,<span
style='background:lime'>065914.00</span>,5503.9366,N,08253.9325,E,1,06,2.78,00146,M,-036,M,,*4B</p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>$GPVTG,000.0,T,351.1,M,000.0,N,000.0,K,A*25</span></p>

</div>

<p class=MsoNormal>                <span style='background:lime'>Цветом</span>
выделено передаваемое время.</p>

<ol style='margin-top:0cm' start=7 type=1>
 <li class=MsoNormal>Устанавливаем <span lang=EN-US>ntp</span><span lang=EN-US>
     </span>сервер из следующих пакетов:</li>
 <ol style='margin-top:0cm' start=1 type=a>
  <li class=MsoNormal>apt-get install ntp</li>
  <li class=MsoNormal>apt-get install ntpdate</li>
 </ol>
 <li class=MsoNormal>Подключаем ЭНКС-2 к серверу в порт <span lang=EN-US>COM</span>1
     (/<span lang=EN-US>dev</span>/<span lang=EN-US>ttyS</span>0). Если к
     другому порту, то соответственно меняем на наименование этого порта ссылки
     в конфигурационных файлах.</li>
 <li class=MsoNormal>Проверяем параметры коммуникационного порта:</li>
 <ol style='margin-top:0cm' start=1 type=a>
  <li class=MsoNormal>stty -a  -F /dev/ttyS0</li>
 </ol>
</ol>

<p class=MsoNormal>&nbsp;</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US
style='background:lime'>speed 9600 baud</span><span lang=EN-US>; rows 0;
columns 0; line = 0;</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>intr =
&lt;undef&gt;; quit = &lt;undef&gt;; erase = &lt;undef&gt;; kill =
&lt;undef&gt;; eof = &lt;undef&gt;; eol = &lt;undef&gt;; eol2 = &lt;undef&gt;;
swtch = &lt;undef&gt;;</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>start =
&lt;undef&gt;; stop = &lt;undef&gt;; susp = &lt;undef&gt;; rprnt = &lt;undef&gt;;
werase = &lt;undef&gt;; lnext = &lt;undef&gt;; flush = &lt;undef&gt;;</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>min = 0;
time = 0;</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>-parenb <span
style='background:lime'>-parodd</span> <span style='background:lime'>cs8</span>
-hupcl -cstopb cread clocal -crtscts</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>ignbrk
-brkint ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl -ixon -ixoff -iuclc
-ixany -imaxbel -iutf8</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>-opost
-olcuc -ocrnl -onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>-isig
icanon -iexten -echo -echoe -echok -echonl -noflsh -xcase -tostop -echoprt
-echoctl –echoke</span></p>

<p class=MsoNormal style='border:none;padding:0cm'>&nbsp;</p>

</div>

<p class=MsoNormal><span style='background:lime'>Цветом</span> выделена
скорость, отсутствие контроля нечетности, и  8 битные данные.</p>

<ol style='margin-top:0cm' start=10 type=1>
 <li class=MsoNormal>При необходимости устанавливаем параметры
     коммуникационного порта, заданные в п.3</li>
 <ol style='margin-top:0cm' start=1 type=a>
  <li class=MsoNormal>stty 9600 -F /dev/ttyS0</li>
 </ol>
 <li class=MsoNormal>Проверяем, что <span lang=EN-US>GPS</span><span
     lang=EN-US> </span>приемник передает данные в формате <span lang=EN-US>NMEA</span></li>
 <ol style='margin-top:0cm' start=1 type=a>
  <li class=MsoNormal><span lang=EN-US>cat /dev/ttyS0</span></li>
 </ol>
</ol>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=MsoNormal style='border:none;padding:0cm'>&nbsp;</p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>$GPGGA,071047.00,5503.9393,N,08253.9304,E,1,06,2.50,00146,M,-036,M,,*42</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>$GPVTG,000.0,T,351.1,M,000.0,N,000.0,K,A*25</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>$GPGGA,071048.00,5503.9393,N,08253.9304,E,1,06,2.50,00146,M,-036,M,,*4D</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>$GPVTG,000.0,T,351.1,M,000.0,N,000.0,K,A*25</span></p>

<p class=MsoNormal style='border:none;padding:0cm'>&nbsp;</p>

</div>

<ol style='margin-top:0cm' start=12 type=1>
 <li class=MsoNormal>Редактируем файл /<span lang=EN-US>etc</span>/<span
     lang=EN-US>default</span>/<span lang=EN-US>ntp</span>, добавив следующие
     строки:</li>
</ol>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>if [ ! -e
/dev/gps0 ]; then</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>    ln -s
/dev/ttyS0 /dev/gps0</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>fi</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>if [ ! -e
/var/log/ntp ]; then</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>    mkdir
/var/log/ntp</span></p>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>    chown
ntp:ntp /var/log/ntp</span></p>

<p class=MsoNormal style='border:none;padding:0cm'>fi</p>

</div>

<p class=MsoNormal>Драйвер приемника, передающего данные по стандарту NMEA,
живет по адресу127.127.20.<i><span style='background:lime'>x</span></i>&nbsp;(в
этом случае читать его ntpd будет из&nbsp;/dev/gps<i><span style='background:
lime'>x</span></i>). Нужно позаботиться о наличии символической ссылки на
соответствующее устройство:&nbsp;/dev/ttyS<i><span style='background:lime'>x</span></i>&nbsp;(для
работы через последовательный порт),/dev/ttyUSB<i>x</i>&nbsp;(для подключения
через USB), или&nbsp;/dev/rfcomm<i>x</i>&nbsp;(для работы через rfcomm). Эти
строчки в конфигурационном файле создают символьную ссылку /<span lang=EN-US>dev</span>/<span
lang=EN-US>gps</span>0  на  устройство /<span lang=EN-US>dev</span>/<span
lang=EN-US>ttyS</span>0 и каталог для лог файлов. </p>

<ol style='margin-top:0cm' start=13 type=1>
 <li class=MsoNormal>Редактируем файл /<span lang=EN-US>etc</span>/<span
     lang=EN-US>ntp</span>.<span lang=EN-US>conf</span><span lang=EN-US> </span>добавив
     в него следующие строчки:</li>
</ol>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=MsoNormal style='border:none;padding:0cm'>logfile
/var/log/ntp/messages</p>

<p class=MsoNormal style='border:none;padding:0cm'>server 127.127.1.0</p>

<p class=MsoNormal style='border:none;padding:0cm'>fudge 127.127.1.0 stratum 10</p>

<p class=MsoNormal style='border:none;padding:0cm'># NMEA GPS driver</p>

<p class=MsoNormal style='border:none;padding:0cm'>server 127.127.20.0 prefer
mode 16</p>

</div>

<ol style='margin-top:0cm' start=14 type=1>
 <li class=MsoNormal>Запускаем <span lang=EN-US>ntp </span>сервер:</li>
 <ol style='margin-top:0cm' start=1 type=a>
  <li class=MsoNormal><span lang=EN-US>service ntp restart</span></li>
 </ol>
 <li class=MsoNormal>В файле /<span lang=EN-US>var</span>/<span lang=EN-US>log</span>/<span
     lang=EN-US>ntp</span>/<span lang=EN-US>messages</span> должна появится
     следующая строчка:</li>
</ol>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>1 Jul
13:13:09 ntpd[3853]: GPS_NMEA(0) serial /dev/gps0 open at 9600 bps</span></p>

</div>

<p class=MsoNormal>При этом&nbsp;ntpq -np&nbsp;сообщит что-то вроде этого:<br>
<br>
</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=MsoNormal style='border:none;padding:0cm'><span lang=EN-US>remote        
  refid      st t when poll reach   delay   offset  jitter</span></p>

<p class=MsoNormal style='border:none;padding:0cm'>==============================================================================</p>

<p class=MsoNormal style='border:none;padding:0cm'> 127.127.1.0    
.LOCL.          10 l  62m   64    0    0.000    0.000   0.000</p>

<p class=MsoNormal style='border:none;padding:0cm'>*127.127.20.0   
.GPS.            0 l   19   64  377    0.000   -8.994   7.037</p>

</div>

<h3><a name="информация_выводимая_командой_ntpq_-p">Информация выводимая
командой ntpq -p</a></h3>

<p class=MsoNormal>Символ в начале строки:</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>пробел - слишком большой страт, цикл или явная ошибка</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>x - фальшивый источник по алгоритму пересечения</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>. - исключен из списка кандидатов из-за большого расстояния</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>- - удалено из списка кандидатов алгоритмом кластеризации</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>+ - входит в конечный список кандидатов</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span># - выбран для синхронизации, но есть 6 лучших кандидатов</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>* - выбран для синхронизации</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>o - выбран для синхронизации, но используется PPS</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>remote</b>&nbsp;- имя удаленного ntp сервера. Если использовать
ключик&nbsp;<b>-n</b>, то будет показан IP</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>refid</b>&nbsp;- показывает откуда этот сервер берет время.
Тут может быть имя (или IP) другого сервера или что то типа .GPS., .PPS. и т.
п.</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>st</b>&nbsp;- Stratum - слой в котором работает данный сервер,
число от 1 до 16 указывающее удаление от источника синхронизации (например GPS
или PPS). Слой данного сервера на 1 больше слоя сервера по которому идет
синхронизацию.</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span lang=EN-US>t</span></b><span lang=EN-US>&nbsp;- </span>Тип
удаленного сервера<span lang=EN-US> (local, unicast, multicast or broadcast)</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>when</b>&nbsp;- сколько секунд назад был получен последний
пакет от данного сервера</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>poll</b>&nbsp;- период опроса сервера, секунд.</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>reach</b>&nbsp;- восьмеричное представление массива из 8-ми
бит, в котором фиксируется 8 последних попыток синхронизации. Если попытка была
успешной, то устанавливается 1. Значение 377 говорит о том, что все 8 последних
попыток были удачными.</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>delay</b>&nbsp;- вычисленная задержка ответов от сервера (RTT)
в миллисекундах</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>offset</b>&nbsp;- разница во времени между локальным и
удаленным сервером, мс. Одно из наиболее важных значений. Чем оно меньше тем
точнее время.</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>jitter</b>&nbsp;- дисперсия отклонения удаленных часов
относительно локальных, вычисленная по нескольким последним запросам, мс. Чем
меньше это значение тем более точная возможно синхронизация.</p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2>Дополнительная информация:</h2>

<h3>Описание параметров протокола <span lang=EN-US>NMEA</span>:</h3>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><b><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F;background:white'>$GPGGA</span></b><span style='font-size:8.5pt;
font-family:"Trebuchet MS","sans-serif";color:#36322F;background:white'>&nbsp;-
GPS Данные о местоположении</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
12.0pt;background:#EEEEEE'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>$GPGGA, hhmmss.ss, 1111.11, a, yyyyy.yy, a, x, xx, x.x, xxx, M,
x.x, M, x.x, xxxx *hh</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman","serif"'>&nbsp;</span></p>

<table class=MsoNormalTable border=1 cellspacing=1 cellpadding=0
 style='background:white'>
 <tr>
  <td style='padding:.75pt .75pt .75pt .75pt'></td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>1</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>2</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>3</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>4</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>5</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>6</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>7</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>8</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>9</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>10</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>11</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>12</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>13</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>14</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:12.0pt'><span style='font-size:8.5pt;
  font-family:"Trebuchet MS","sans-serif";color:#36322F'>15</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'></td>
 </tr>
 <tr>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>$GPGGA,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>hhmmss.ss,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>1111.11,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>a,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>yyyyy.yy,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>a,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>x,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>xx,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>x.x,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>xxx,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>M,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>x.x,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>M,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>x.x,</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>xxxx</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>*hh</span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  12.0pt'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
  color:#36322F'>&lt;CR&gt;&lt;LF&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>Гринвичское время на момент определения местоположения.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>Географическая широта местоположения./li&gt;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>Север/Юг (N/S).</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>Географическая долгота местоположения.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>Запад/Восток (E/W).</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>Индикатор качества GPS сигнала:</span></p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:10.0pt;font-family:"Courier New";
color:#36322F'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";color:#36322F'>0
= Определение местоположения не возможно или не верно;</span></p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:10.0pt;font-family:"Courier New";
color:#36322F'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";color:#36322F'>1
= GPS режим обычной точности, возможно определение местоположения;</span></p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:10.0pt;font-family:"Courier New";
color:#36322F'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";color:#36322F'>2
= Дифференциальный GPS режим, точность обычная, возможно определение
местоположения;</span></p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:10.0pt;font-family:"Courier New";
color:#36322F'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";color:#36322F'>3
= GPS режим прецизионной точности, возможно определение местоположения.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>Количество используемых спутников (00-12, может отличаться от
числа видимых).</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>Фактор Ухудшения Точности Плановых Координат (HDOP).</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>9.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>Высота антенны приёмника над/ниже уровня моря.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>10.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";color:#36322F'>Единица
измерения высоты расположения антенны, метры.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>11.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";color:#36322F'>Геоидальное
различие - различие между земным эллипсоидом WGS-84 и уровнем моря(геоидом),
”-” = уровень моря ниже эллипсоида.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>12.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";color:#36322F'>Единица
измерения различия, метры.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>13.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";color:#36322F'>Возраст
Дифференциальных данных GPS - Время в секундах с момента последнего SC104 типа
1 или 9 обновления, заполнено нулями, если дифференциальный режим не используется.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>14.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";color:#36322F'>Индификатор
станции, передающей дифференциальные поправки, ID, 0000-1023.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
12.0pt;background:white'><span style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";
color:#36322F'>15.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-size:8.5pt;font-family:"Trebuchet MS","sans-serif";color:#36322F'>Контрольная
сумма строки.</span></p>

<p class=MsoNormal><b><i><span style='font-size:8.5pt;line-height:115%;
font-family:"Trebuchet MS","sans-serif";color:#36322F;background:white'>Пример
сообщения:</span></i></b><span style='font-size:8.5pt;line-height:115%;
font-family:"Trebuchet MS","sans-serif";color:#36322F'><br>
<span style='background:white'>Сигнал не распознан:
$GPGGA,235947.000,0000.0000,N,00000.0000,E,0,00,0.0,0.0,M,,,,0000*00</span><br>
<span style='background:white'>Сигнал распознан:
$GPGGA,092204.999,4250.5589,S,14718.5084,E,1,04,24.4,19.7,M,,,,0000*1F</span><br>
<br>
</span></p>

<h3>Описание драйвера <span lang=EN-US>GPS</span><span lang=EN-US> </span><span
lang=EN-US>ntp</span><span lang=EN-US> </span>сервера:</h3>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=EN-US>Address: 127.127.20.u</span></p>

<p class=MsoNormal><span lang=EN-US>Reference ID: GPS</span></p>

<p class=MsoNormal><span lang=EN-US>Driver ID: GPS_NMEA</span></p>

<p class=MsoNormal><span lang=EN-US>Serial Port: /dev/gpsu; 4800 - 115200 bps,
8-bits, no parity</span></p>

<p class=MsoNormal><span lang=EN-US>Serial Port: /dev/gpsppsu; for just the PPS
signal (this is tried first for PPS, before /dev/gpsu)</span></p>

<p class=MsoNormal><span lang=EN-US>Serial Port: /dev/gpsu; symlink to
server:port (for nmead)</span></p>

<p class=MsoNormal><span lang=EN-US>Features: tty_clk</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=EN-US>Description</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>This driver supports GPS receivers with the
$GPRMC, $GPGLL, $GPGGA, $GPZDA and $GPZDG NMEA sentences by default.  Note that
Accord's custom NMEA sentence $GPZDG reports using the GPS timescale, while the
rest of the sentences report UTC.  The difference between the two is a whole
number of seconds which increases with each leap second insertion in UTC.  To
avoid problems mixing UTC and GPS timescales, the driver disables processing of
UTC sentences once $GPZDG is received.</span></p>

<p class=MsoNormal><span lang=EN-US>The driver expects the receiver to be set
up to transmit at least one supported sentence every second.</span></p>

<p class=MsoNormal><span lang=EN-US>The accuracy depends on the receiver used.
Inexpensive GPS models are available with a claimed PPS signal accuracy of 1 </span>&#956;<span
lang=EN-US>s or better relative to the broadcast signal. However, in most cases
the actual accuracy is limited by the precision of the timecode and the
latencies of the serial interface and operating system.</span></p>

<p class=MsoNormal><span lang=EN-US>If the Operating System supports PPSAPI
(RFC 2783), fudge flag1 1 enables its use.</span></p>

<p class=MsoNormal><span lang=EN-US>The various GPS sentences that this driver
recognises look like this:</span></p>

<p class=MsoNormal><span lang=EN-US>(others quietly ignored)</span></p>

<p class=MsoNormal><span lang=EN-US>Accepted NMEA sentences</span></p>

<p class=MsoNormal><span lang=EN-US>Sentence            Vendor</span></p>

<p class=MsoNormal><span lang=EN-US>$GPRMC,UTC,POS_STAT,LAT,LAT_REF,LON,LON_REF,SPD,HDG,DATE,MAG_VAR,MAG_REF*CS&lt;cr&gt;&lt;lf&gt;</span></p>

<p class=MsoNormal><span lang=EN-US>$GPGLL,LAT,LAT_REF,LON,LON_REF,UTC,POS_STAT*CS&lt;cr&gt;&lt;lf&gt;</span></p>

<p class=MsoNormal><span lang=EN-US>$GPGGA,UTC,LAT,LAT_REF,LON,LON_REF,FIX_MODE,SAT_USED,HDOP,ALT,ALT_UNIT,GEO,G_UNIT,D_AGE,D_REF*CS&lt;cr&gt;&lt;lf&gt;</span></p>

<p class=MsoNormal><span lang=EN-US>$GPZDA,UTC,DD,MM,YYYY,TH,TM,*CS&lt;cr&gt;&lt;lf&gt;</span></p>

<p class=MsoNormal><span lang=EN-US>$GPZDG,GPSTIME,DD,MM,YYYY,AA.BB,V*CS&lt;cr&gt;&lt;lf&gt;  Accord</span></p>

<p class=MsoNormal><span lang=EN-US>NMEA data items</span></p>

<p class=MsoNormal><span lang=EN-US>Symbol Meaning and Format</span></p>

<p class=MsoNormal><span lang=EN-US>UTC       Time of day on UTC timescale.
Hours, minutes and seconds [fraction (opt.)]. (hhmmss[.fff])</span></p>

<p class=MsoNormal><span lang=EN-US>POS_STAT          Position status. (A =
Data valid, V = Data invalid)</span></p>

<p class=MsoNormal><span lang=EN-US>LAT        Latitude (llll.ll)</span></p>

<p class=MsoNormal><span lang=EN-US>LAT_REF              Latitude direction. (N
= North, S = South)</span></p>

<p class=MsoNormal><span lang=EN-US>LON       Longitude (yyyyy.yy)</span></p>

<p class=MsoNormal><span lang=EN-US>LON_REF             Longitude direction (E
= East, W = West)</span></p>

<p class=MsoNormal><span lang=EN-US>SPD        Speed over ground. (knots) (x.x)</span></p>

<p class=MsoNormal><span lang=EN-US>HDG      Heading/track made good (degrees
True) (x.x)</span></p>

<p class=MsoNormal><span lang=EN-US>DATE     Date (ddmmyy)</span></p>

<p class=MsoNormal><span lang=EN-US>MAG_VAR         Magnetic variation
(degrees) (x.x)</span></p>

<p class=MsoNormal><span lang=EN-US>MAG_REF           Magnetic variation (E =
East, W = West)</span></p>

<p class=MsoNormal><span lang=EN-US>FIX_MODE         Position Fix Mode (0 =
Invalid, &gt;0 = Valid)</span></p>

<p class=MsoNormal><span lang=EN-US>SAT_USED          Number of Satellites used
in solution</span></p>

<p class=MsoNormal><span lang=EN-US>HDOP    Horizontal Dilution of Precision</span></p>

<p class=MsoNormal><span lang=EN-US>ALT        Antenna Altitude</span></p>

<p class=MsoNormal><span lang=EN-US>ALT_UNIT           Altitude Units
(Metres/Feet)</span></p>

<p class=MsoNormal><span lang=EN-US>GEO       Geoid/Elipsoid separation</span></p>

<p class=MsoNormal><span lang=EN-US>G_UNIT               Geoid units (M/F)</span></p>

<p class=MsoNormal><span lang=EN-US>D_AGE Age of last DGPS Fix</span></p>

<p class=MsoNormal><span lang=EN-US>D_REF   Reference ID of DGPS station</span></p>

<p class=MsoNormal><span lang=EN-US>GPSTIME             Time of day on GPS
timescale. Hours, minutes and seconds [fraction (opt.)]. (hhmmss[.f])</span></p>

<p class=MsoNormal><span lang=EN-US>DD          Day of the month (1-31)</span></p>

<p class=MsoNormal><span lang=EN-US>MM       Month of the year (1-12)</span></p>

<p class=MsoNormal><span lang=EN-US>YYYY      Year</span></p>

<p class=MsoNormal><span lang=EN-US>AA.BB   Denotes the signal strength (should
be &lt; 05.00)</span></p>

<p class=MsoNormal><span lang=EN-US>V             GPS sync status</span></p>

<p class=MsoNormal><span lang=EN-US>   '0' =&gt; INVALID time,</span></p>

<p class=MsoNormal><span lang=EN-US>   '1' =&gt; accuracy of +/- 20ms,</span></p>

<p class=MsoNormal><span lang=EN-US>   '2' =&gt; accuracy of +/- 100ns</span></p>

<p class=MsoNormal><span lang=EN-US>CS            Checksum</span></p>

<p class=MsoNormal><span lang=EN-US>&lt;cr&gt;&lt;lf&gt;              Sentence
terminator.</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>The 'mode' byte</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>Specific GPS sentences and bitrates may be
selected by setting bits of the 'mode' in the server configuration line:</span></p>

<p class=MsoNormal><span lang=EN-US>  server 127.127.20.x mode X</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>mode byte bits and bit groups</span></p>

<p class=MsoNormal><span lang=EN-US>Bit          Dec.       Meaning</span></p>

<p class=MsoNormal><span lang=EN-US>0             1             process $GPMRC</span></p>

<p class=MsoNormal><span lang=EN-US>1             2             process $GPGGA</span></p>

<p class=MsoNormal><span lang=EN-US>2             4             process $GPGLL</span></p>

<p class=MsoNormal><span lang=EN-US>3             8             process $GPZDA
or $GPZDG</span></p>

<p class=MsoNormal><span lang=EN-US>4-6         0             linespeed 4800
bps</span></p>

<p class=MsoNormal><span lang=EN-US>16           linespeed 9600 bps</span></p>

<p class=MsoNormal><span lang=EN-US>32           linespeed 19200 bps</span></p>

<p class=MsoNormal><span lang=EN-US>48           linespeed 38400 bps</span></p>

<p class=MsoNormal><span lang=EN-US>64           linespeed 57600 bps</span></p>

<p class=MsoNormal><span lang=EN-US>80           linespeed 115200 bps</span></p>

<p class=MsoNormal><span lang=EN-US>7             128         Write the
sub-second fraction of the receive time stamp to the clockstat file for all
recognised NMEA sentences. This can be used to get a useful value for fudge
time2.</span></p>

<p class=MsoNormal><span lang=EN-US>Caveat: This will fill your clockstat file
rather fast. Use it only temporarily to get the numbers for the NMEA sentence
of your choice.</span></p>

<p class=MsoNormal><span lang=EN-US>The default (mode 0) is to process all
supported sentences at a linespeed of 4800 bps, which results in the first one
received and recognised in each cycle being used.  If only specific sentences
should be recognised, then the mode byte must be chosen to enable only the
selected ones.  Multiple sentences may be selected by adding their mode bit
values, but of those enabled still only the first received sentence in a cycle
will be used.  Using more than one sentence per cycle is impossible, because</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>there is only fudge time2 available to
compensate for transmission delays but every sentence would need a different
one and</span></p>

<p class=MsoNormal><span lang=EN-US>using more than one sentence per cycle
overstuffs the internal data filters.</span></p>

<p class=MsoNormal><span lang=EN-US>The driver uses 4800 bits per second by default,
but faster bitrates can be selected using bits 4 to 6 of the mode field.</span></p>

<p class=MsoNormal><span lang=EN-US>Caveat: Using higher line speeds does not
necessarily increase the precision of the timing device.  Higher line speeds
are not necessarily helpful for the NMEA driver, either.  They can be used to
accomodate for an amount of data that does not fit into a 1-second cycle at
4800 bps, but high-speed high-volume NMEA data is likely to cause trouble with
the serial line driver since NMEA supports no protocol handshake.  Any device that
is exclusively used for time synchronisation purposes should be configured to
transmit the relevant data only, e.g. one $GPRMC or $GPZDA per second, at a
linespeed of 4800 bps or 9600 bps.</span></p>

<p class=MsoNormal><span lang=EN-US>Configuring NMEA Refclocks might give
further useful hints for specific hardware devices that exhibit strange or
curious behaviour.</span></p>

<p class=MsoNormal><span lang=EN-US>To make a specific setting, select the
corresponding decimal values from the mode byte table, add them all together
and enter the resulting decimal value into the clock configuration line.</span></p>

<p class=MsoNormal><span lang=EN-US>Setting up the Garmin GPS-25XL</span></p>

<p class=MsoNormal><span lang=EN-US>Switch off all output with by sending it
the following string.</span></p>

<p class=MsoNormal><span lang=EN-US>&quot;$PGRMO,,2&lt;cr&gt;&lt;lf&gt;&quot;</span></p>

<p class=MsoNormal><span lang=EN-US>Now switch only $GPRMC on by sending it the
following string.</span></p>

<p class=MsoNormal>&quot;$PGRMO,GPRMC,1&lt;cr&gt;&lt;lf&gt;&quot;</p>

<p class=MsoNormal><span lang=EN-US>On some systems the PPS signal isn't
switched on by default. It can be switched on by sending the following string.</span></p>

<p class=MsoNormal>&quot;$PGRMC,,,,,,,,,,,,2&lt;cr&gt;&lt;lf&gt;&quot;</p>

<p class=MsoNormal><span lang=EN-US>Monitor Data</span></p>

<p class=MsoNormal><span lang=EN-US>The GPS sentence that is used is written to
the clockstats file and available with ntpq -c clockvar.</span></p>

<p class=MsoNormal><span lang=EN-US>Fudge Factors</span></p>

<p class=MsoNormal><span lang=EN-US>time1 time</span></p>

<p class=MsoNormal><span lang=EN-US>Specifies the PPS time offset calibration
factor, in seconds and fraction, with default 0.0.</span></p>

<p class=MsoNormal><span lang=EN-US>time2 time</span></p>

<p class=MsoNormal><span lang=EN-US>Specifies the serial end of line time
offset calibration factor, in seconds and fraction, with default 0.0.</span></p>

<p class=MsoNormal><span lang=EN-US>stratum number</span></p>

<p class=MsoNormal><span lang=EN-US>Specifies the driver stratum, in decimal
from 0 to 15, with default 0.</span></p>

<p class=MsoNormal><span lang=EN-US>refid string</span></p>

<p class=MsoNormal><span lang=EN-US>Specifies the driver reference identifier,
an ASCII string from one to four characters, with default GPS.</span></p>

<p class=MsoNormal><span lang=EN-US>flag1 0 | 1</span></p>

<p class=MsoNormal><span lang=EN-US>Disable PPS signal processing if 0
(default); enable PPS signal processing if 1.</span></p>

<p class=MsoNormal><span lang=EN-US>flag2 0 | 1</span></p>

<p class=MsoNormal><span lang=EN-US>If PPS signal processing is enabled,
capture the pulse on the rising edge if 0 (default); capture on the falling
edge if 1.</span></p>

<p class=MsoNormal><span lang=EN-US>flag3 0 | 1</span></p>

<p class=MsoNormal><span lang=EN-US>If PPS signal processing is enabled, use
the ntpd clock discipline if 0 (default); use the kernel discipline if 1.</span></p>

<p class=MsoNormal><span lang=EN-US>flag4 0 | 1</span></p>

<p class=MsoNormal><span lang=EN-US>Obscures location in timecode: 0 for
disable (default), 1 for enable.</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
